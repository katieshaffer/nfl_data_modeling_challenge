version: 2

models:
  - name: fct_fantasy_point_leaders
    description: "Fact table ranking players by their fantasy performance using both standard and PPR scoring."
    meta:
      lightdash:
        join_to_source: []
    columns:
      - name: player_id
        description: "Unique identifier for the player."
        meta:
          dimension:
            type: string
      - name: player_name
        description: "Name of the player."
        meta:
          dimension:
            type: string
      - name: position
        description: "Player's position (e.g., QB, RB, WR, TE)."
        meta:
          dimension:
            type: string
      - name: recent_team
        description: "The player's most recent team."
        meta:
          dimension:
            type: string
      - name: total_fantasy_points
        description: "Total fantasy points scored by the player (standard scoring) across the considered period."
        meta:
          metrics:
            total_std_points:
              type: sum
              label: "Total Standard Points"
              round: 1
      - name: total_fantasy_points_ppr
        description: "Total fantasy points scored by the player under PPR (points per reception) scoring across the considered period."
        meta:
          metrics:
            total_ppr_points:
              type: sum
              label: "Total PPR Points"
              round: 1
      - name: games_played
        description: "Number of games (weeks) the player participated in."
        meta:
          metrics:
            game_count:
              type: count
              label: "Games Played"
      - name: avg_fantasy_points_per_game
        description: "Average standard fantasy points per game played."
        meta:
          metrics:
            avg_std_points:
              type: average
              label: "Avg Standard Points/Game"
              round: 1
      - name: avg_fantasy_points_ppr_per_game
        description: "Average PPR fantasy points per game played."
        meta:
          metrics:
            avg_ppr_points:
              type: average
              label: "Avg PPR Points/Game"
              round: 1

  - name: fct_red_zone_player_stats
    description: "Fact table summarizing player performance within the red zone, capturing rushing and passing opportunities."
    meta:
      lightdash:
        join_to_source: []
    columns:
      - name: fantasy_player_id
        description: "Fantasy-specific unique identifier for the player."
        meta:
          dimension:
            type: string
      - name: fantasy_player_name
        description: "Name of the player as recognized for fantasy purposes."
        meta:
          dimension:
            type: string
      - name: total_opportunities
        description: "Sum of a player's total red zone rush attempts and targets."
        meta:
          metrics:
            rz_opportunities:
              type: sum
              label: "Red Zone Opportunities"
      - name: total_rush_attempts
        description: "Total number of red zone rushing attempts by the player."
        meta:
          metrics:
            rz_rushes:
              type: sum
              label: "Red Zone Rush Attempts"
      - name: total_targets
        description: "Total number of red zone targets directed to the player."
        meta:
          metrics:
            rz_targets:
              type: sum
              label: "Red Zone Targets"
      - name: total_pass_completions
        description: "Total number of red zone passes completed to the player."
        meta:
          metrics:
            rz_completions:
              type: sum
              label: "Red Zone Completions"

  - name: fct_team_comparison
    description: "Team comparison metrics for Super Bowl prediction"
    meta:
      lightdash:
        join_to_source: []
    columns:
      - name: team
        meta:
          dimension:
            type: string
      - name: season_avg_epa
        meta:
          metrics:
            avg_team_epa:
              type: average
              label: "Average EPA per Team"
              round: 3
      - name: red_zone_efficiency
        meta:
          metrics:
            redzone_efficiency:
              type: average
              label: "Red Zone Efficiency"
              round: 2
              format: "percent"
      - name: qb_epa_per_game
        meta:
          metrics:
            qb_game_epa:
              type: average
              label: "QB EPA per Game"
              round: 3

  - name: fct_superbowl_prediction
    description: "Final Super Bowl prediction probabilities"
    meta:
      lightdash:
        join_to_source: []
    columns:
      - name: team
        meta:
          dimension:
            type: string
      - name: win_probability
        meta:
          metrics:
            win_prob:
              type: average
              label: "Win Probability"
              round: 2
              format: "percent"
            max_win_prob:
              type: max
              label: "Highest Win Probability"
              round: 2
              format: "percent"