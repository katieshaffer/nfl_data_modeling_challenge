version: 2

models:
  - name: fct_fantasy_point_leaders
    description: "Fact table ranking players by their fantasy performance using both standard and PPR scoring."
    columns:
      - name: player_id
        description: "Unique identifier for the player."
      - name: player_name
        description: "Name of the player."
      - name: position
        description: "Player's position (e.g., QB, RB, WR, TE)."
      - name: recent_team
        description: "The player's most recent team."
      - name: total_fantasy_points
        description: "Total fantasy points scored by the player (standard scoring) across the considered period."
      - name: total_fantasy_points_ppr
        description: "Total fantasy points scored by the player under PPR (points per reception) scoring across the considered period."
      - name: games_played
        description: "Number of games (weeks) the player participated in."
      - name: avg_fantasy_points_per_game
        description: "Average standard fantasy points per game played."
      - name: avg_fantasy_points_ppr_per_game
        description: "Average PPR fantasy points per game played."
      - name: standard_rank
        description: "The player's rank among all players based on total standard fantasy points."
      - name: ppr_rank
        description: "The player's rank among all players based on total PPR fantasy points."

  - name: fct_red_zone_player_stats
    description: "Fact table summarizing player performance within the red zone, capturing rushing and passing opportunities."
    columns:
      - name: fantasy_player_id
        description: "Fantasy-specific unique identifier for the player."
      - name: fantasy_player_name
        description: "Name of the player as recognized for fantasy purposes."
      - name: total_opportunities
        description: "Sum of a player's total red zone rush attempts and targets (pass attempts to them)."
      - name: total_rush_attempts
        description: "Total number of red zone rushing attempts by the player."
      - name: total_targets
        description: "Total number of red zone targets (pass attempts) directed to the player."
      - name: total_pass_completions
        description: "Total number of red zone passes completed to the player."

  - name: fct_player_details
    description: "Fact model detailed player information"
    columns:
      - name: player_id
        description: "Unique identifier for the player."
      - name: player_name
        description: "Name of the player."
      - name: first_name
        description: "First name of the player."
      - name: last_name
        description: "Last name of the player."  
      - name: position
        description: "Player's position (e.g., QB, RB, WR, TE)."
      - name: position_group
        description: "High-level position group (e.g., skill players, QBs)"  
      - name: weight
        description: "Player's weight in pounds."
        meta:
          metrics: 
            player_weight:
              type: number
            avg_weight:
              type: average
            min_weight:
              type: min
            max_weight:
              type: max  
      - name: height
        description: "Player's height in inches."
        meta:
          metrics: 
            player_height:
              type: number
            avg_height:
              type: average
            min_height:
              type: min
            max_height:
              type: max   
      - name: player_age
        description: "Player's age "
        meta:
          metrics: 
            age:
              type: number
            avg_age:
              type: average
            min_age:
              type: min
            max_age:
              type: max  
      - name: birth_date
        description: "Player's birth date."
      - name: college
        description: "College the player attended."
      - name: entry_year
        description: "Year the player entered the league."
      - name: rookie_year
        description: "Playerâ€™s rookie season year."

  - name: fct_games_result
    description: "Fact table containing results of NFL games, including scores, outcomes, and fantasy points."
    columns:
      - name: game_id
        description: "Unique identifier for each game."
        meta:
          metrics:
            games:
              type: count_distinct    
      - name: game_date
        description: "Date the game was played."
      - name: season_type
        description: "Type of season (e.g., regular season or post season)."
      - name: season_week
        description: "Week of the season in which the game was played."
      - name: home_team
        description: "Abbreviation of the home team."
      - name: away_team
        description: "Abbreviation of the away team."
      - name: total_home_score
        description: "Total points scored by the home team."
      - name: total_away_score
        description: "Total points scored by the away team."
      - name: winning_team
        description: "Abbreviation of the team that won the game. Null in case of a tie."
      - name: is_home_team_win
        description: "Boolean flag indicating if the home team won (1) or not (0)."
        meta:
          metrics:
            home_team_wins:
              type: sum
      - name: is_away_team_win
        description: "Boolean flag indicating if the away team won (1) or not (0)."
        meta:
          metrics:
            away_team_wins:
              type: sum
      - name: is_overtime
        description: "Boolean flag indicating if the game went into overtime (1) or not (0)."
        meta:
          metrics:
            overtime_games:
              type: sum
      - name: home_fantasy_points
        description: "Total fantasy points scored by the home team based on standard scoring rules."
      - name: away_fantasy_points
        description: "Total fantasy points scored by the away team based on standard scoring rules."
      - name: home_fantasy_points_ppr
        description: "Total fantasy points scored by the home team based on PPR (points per reception) scoring."
      - name: away_fantasy_points_ppr
        description: "Total fantasy points scored by the away team based on PPR (points per reception) scoring."

  - name: fct_team_standings
    description: "Fact table containing team standings, including wins, rankings, and fantasy points."
    columns:
      - name: team_name
        description: "Full name of the team."
      - name: team_abbr
        description: "Abbreviation of the team name."
      - name: team_conf
        description: "Conference the team belongs to (e.g., AFC or NFC)."
      - name: team_division
        description: "Division the team belongs to within its conference."
      - name: team_nick
        description: "Team's nickname or mascot."
      - name: wins
        description: "Total number of wins by the team."
        meta:
          metrics: 
            total_wins:
              type: sum
      - name: loses
        description: "Total number of losses by the team."
        meta: 
          metrics: 
            total_loses:
              type: sum
      - name: total_points_scored
        description: "Total points scored by the team throughout the season."
      - name: total_points_lost
        description: "Total points conceded by the team throughout the season."
      - name: total_fantasy_points
        description: "Total fantasy points accumulated by the team based on standard scoring rules."
      - name: total_fantasy_points_ppr
        description: "Total fantasy points accumulated by the team based on PPR (points per reception) scoring."
      - name: division_rank
        description: "Team's rank within its division."
      - name: conference_rank
        description: "Team's rank within its conference."
      - name: home_wins
        description: "Total number of games won at home."
        meta:
          metrics: 
            total_home_wins:
              type: sum
      - name: away_wins
        description: "Total number of games won away from home."
        meta: 
          metrics: 
            total_away_wins:
              type: sum


  - name: fct_injuries
    description: "Fact table containing injury data for NFL players, including injury type and duration."
    meta:
      joins:
        - join: fct_team_standings
          sql_on: ${fct_injuries.team} = ${fct_team_standings.team_abbr}
        - join: fct_games_result
          sql_on: ${fct_games_result.season_week} = ${fct_injuries.week}
    columns:
      - name: week
        description: "Week of the season when the injury was reported."
      - name: team
        description: "Abbreviation of the team the injured player belongs to."
      - name: position
        description: "Player's position on the field (e.g., QB, RB, WR, etc.)."
      - name: full_name
        description: "Full name of the injured player."
        meta:
          metrics: 
            players_injured:
              type: count_distinct
      - name: injury
        description: "Description of the player's injury."
      - name: duration
        description: "Estimated duration of time the player is expected to be out due to injury."
        meta:
          metrics: 
            avg_duration:
              type: average


      
